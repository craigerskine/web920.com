{%- import 'components/partials.njk' as el -%}
{%- set pagetitle -%}
{%- if title %}{{ _site.meta.title +' { '+ title +' }' }}{% else %}{{ _site.meta.title or _site.meta.title }} { {{ _site.meta.desc }} }{% endif -%}
{%- endset -%}

<!doctype html>
<html lang="en" class="bg-transparent antialiased" x-data="{ menu: false }">

  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>{{ pagetitle }}</title>
    <meta name="description" content="{{ _site.meta.desc }}" />
    <meta name="author" content="{{ _site.meta.author }} - {{ _site.meta.author_url }}" />
    <meta name="generator" content="{{ eleventy.generator }}" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <link rel="icon" type="image/x-icon" href="{{ '/' | url }}favicon.ico" />
    <link href="https://fonts.gstatic.com" rel="preconnect" />
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@100..800&display=swap" rel="stylesheet" />

    <meta property="og:title" content="{{ pagetitle }}" />
    <meta property="og:description" content="{{ _site.meta.description }}" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="{{ page.url | url }}" />
    <meta property="og:image" content="{{ '/' | url }}_assets/img/og.png" />

    {% renderblock 'css' %}

    <script>
      // color mode init
      if (localStorage.getItem('color-mode') === 'dark' || (window.matchMedia('(prefers-color-scheme: dark)').matches && !localStorage.getItem('color-mode'))) {
        document.documentElement.classList.add('dark');
      }
    </script>

  </head>

  <body @keyup.escape="menu = false" class="bg-gray-50 text-gray-700 font-mono !block" style="display: none;" x-cloak>

    <div class="min-h-screen flex-(& col) relative">


      <header class="w-full flex-none relative">
        <nav class="mx-auto py-6 px-4 max-w-7xl flex items-center justify-between lg:(px-8)" aria-label="Global">
          <div class="lg:(flex-1)">
            <a href="{{ '/_index.html' | url }}" class="w-32 block motion-safe:(hover:(animate-blob))">
              <span class="sr-only">web920</span>
              {% include "logo.njk" %}
            </a>
          </div>
          <div class="lg:(hidden)">
            <button type="button" @click="menu = !menu" class="-m-2.5 flex items-center justify-center rounded-md p-2.5 text-(2xl gray-700)">
              <span class="sr-only">Open main menu</span>
              <iconify-icon icon="mdi:menu" inline class="iconify"></iconify-icon>
            </button>
          </div>
          <ul class="text-sm leading-6 font-semibold hidden lg:(flex gap-x-12)">
            {%- for item in collections.all | eleventyNavigation %}
            <li>
              <a href="{{ item.url | url }}" class="text-gray-900 block relative motion-safe:(transition) hover:(text-gray-500)"{% if item.url == page.url or item.url in page.url %} aria-current="page"{% endif %}>
                {{ item.key }}
                {% if item.url == page.url or item.url in page.url %}<b class="w-full h-[2px] bg-gray-500/30 absolute inset-x-0 -bottom-1 rounded-sm -rotate-2"></b>{% endif %}
              </a>
            </li>
            {%- endfor %}
          </ul>
          <div class="hidden lg:(flex-(& 1) items-center justify-end)">
            {{ el.mode() }}
          </div>
        </nav>
        <!-- Mobile menu, show/hide based on menu open state. -->
        <div class="lg:(hidden)" x-show="menu" role="dialog" aria-modal="true">
          <!-- Background backdrop, show/hide based on slide-over state. -->
          <div x-show="menu" @click="menu = false" class="bg-black/80 fixed inset-0 z-50 motion-safe:(transition ease-in-out)"
            x-transition:enter-start="opacity-0 scale-110 blur-lg"
            x-transition:enter-end="opacity-100 scale-100"
            x-transition:leave-start="opacity-100 scale-100"
            x-transition:leave-end="opacity-0 scale-110 blur-lg"
          ></div>
          <div x-show="menu" x-trap="menu" class="p-6 w-full max-w-sm bg-gray-50 overflow-y-auto fixed inset-y-0 right-0 z-50 motion-safe:(transition duration-300 ease-in-out) sm:(ring-(1 gray-900/10)"
            x-transition:enter-start="opacity-0 translate-x-10 blur-lg"
            x-transition:enter-end="opacity-100 translate-x-0"
            x-transition:leave-start="opacity-100 translate-x-0"
            x-transition:leave-end="opacity-0 translate-x-10 blur-lg"
          >
            <div class="flex items-center justify-end">
              <button type="button" @click="menu = false" class="-m-2.5 p-2.5 text-(2xl gray-700)">
                <span class="sr-only">Close menu</span>
                <iconify-icon icon="mdi:close" inline class="iconify"></iconify-icon>
              </button>
            </div>
            <div class="">
              <div class="divide-y divide-gray-500/10">
                <ul class="space-y-2 py-6">
                  {%- for item in collections.all | eleventyNavigation %}
                  <li>
                    <a href="{{ item.url | url }}" class="-mx-3 py-2 px-3 text-(gray-900 base) leading-7 font-semibold block rounded-lg motion-safe:(transition) hover:(bg-gray-100/100)
                    {% if item.url == page.url or item.url in page.url %}bg-gray-100/50{% endif %}
                    "{% if item.url == page.url or item.url in page.url %} aria-current="page"{% endif %}>
                      {{ item.key }}
                    </a>
                  </li>
                  {%- endfor %}
                </ul>
                <div class="py-6">
                  {{ el.mode() }}
                </div>
              </div>
            </div>
          </div>
        </div>
      </header>
      <main class="w-full flex-1">
        {{ content | safe }}
      </main>

      {%- macro footer_nav(title='Title',sub='',url='#') %}
      <li class="py-3 leading-tight">
        <a href="{{ url | url }}" class="group motion-safe:(transition) hover:(text-brand-600)">
          {%- if sub %}<small class="pb-1 text-xs block opacity-80">{{ sub }}</small>{%- endif %}
          <strong>{{ title }}</strong>
        </a>
      </li>
      {%- endmacro %}
      <footer class="mt-8 pt-8 w-full bg-white flex-none md:(mt-24 pt-24) dark:(bg-black/30)">
        <div class="mx-auto px-4 max-w-7xl">
          <div class="pb-8 text-center space-y-5 md:(pb-12 text-start flex items-start justify-between gap-5 space-y-0)">
            <nav class="flex-none">
              <a href="{{ '/_index.html' | url }}" class="group w-32 inline-flex transform motion-safe:(transition hover:(animate-blob))">
                {% include "logo.njk" %}
              </a>
              <p class="mx-auto mt-2 max-w-xs text-(gray-500 sm) md:(mx-0 text-base)">{{ home_page.hero.heading }}</p>
              <ul class="py-5 text-2xl flex justify-center gap-8 md:(justify-start)">
                {%- for item in _site.social %}
                <li>
                  <a href="{{ item.url }}" class="text-gray-500 motion-safe:(transition) hover:(text-{{ item.color }}-500 opacity-100)">
                    <iconify-icon icon="{{ item.ico }}" inline="false" class="iconify"></iconify-icon>
                  </a>
                </li>
                {%- endfor %}
              </ul>
            </nav>
            <nav class="w-full text-sm flex-(& col) gap-10 md:(max-w-xl flex-row justify-end gap-32)">
              {%- for cat in _site.footer %}
              <ul>
                <li>
                  <b class="pb-1.5 font-black uppercase block opacity-75">{{ cat.title }}</b>
                  <ul>
                    {# sitemap #}
                    {%- if cat.title == 'Sitemap' %}
                      {%- for item in collections.all | eleventyNavigation %}
                      {{ footer_nav(title=item.key,sub=item.title,url=item.url) }}
                      {%- endfor %}
                    {# tech stack #}
                    {%- else %}
                      {%- for item in cat.nav %}
                      {{ footer_nav(title=item.title,sub=item.sub,url=item.url) }}
                      {%- endfor %}
                    {%- endif %}
                  </ul>
                </li>
              </ul>
              {%- endfor %}
            </nav>
          </div>
          <div class="border-(t gray-500/20) py-3 text-(xs pri-500 center) leading-relaxed space-y-3 md:(py-6 text-start flex-(& wrap) justify-between space-y-0)">
            <p>
              &copy;{% year %} {{ _site.meta.title }}
              <span class="block">Season 1: <a href="{{ _site.meta.author_url | url }}" class="text-brand-700 motion-safe:(transition) hover:(text-brand-900)">{{ _site.meta.author }}</a></span>
            </p>
            <p class="md:(text-end)">
              Updated on:
              <time datetime="{{ _utils.time.raw }}" class="block">{{ _utils.time.formatted }}</time>
            </p>
          </div>
        </div>
      </footer>

    </div>

    {% renderblock 'js' %}

    <script src="{{ '/' | url }}_assets/js/_app.js?v={% bust %}"></script>

  </body>

</html>